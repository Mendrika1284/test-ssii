// Generated by CoffeeScript 2.5.1
(function() {
  var Parser, exact;

  Parser = require('@shimaore/jsonparse');

  exact = function(numberReviver) {
    return function(p) {
      return p.buffer(false).parse(function(res, cb) {
        var parser;
        parser = new Parser();
        if (numberReviver != null) {
          parser.numberReviver = function(text) {
            var error, result;
            try {
              result = numberReviver(text);
            } catch (error1) {
              error = error1;
              return error;
            }
            this.onToken(Parser.C.NUMBER, result);
          };
        }
        res.body = null;
        parser.onError = function(err) {
          cb(err, res);
        };
        parser.onValue = function(value) {
          if (this.stack.length === 0) {
            cb(null, value);
          }
        };
        res.on('data', function(chunk) {
          parser.write(chunk);
        });
        res.once('end', function() {});
      });
    };
  };

  module.exports = exact;

}).call(this);
